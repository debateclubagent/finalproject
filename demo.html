<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å¤šè§’è‰²æ€ç»´ç™½æ¿ Demo</title>
  <script src="https://unpkg.com/tldraw@1.5.6/dist/tldraw.umd.min.js"></script>
  <style>
    html, body, #whiteboard {
      margin: 0;
      height: 100%;
      width: 100%;
      display: flex;
    }
    #board {
      flex: 3;
      border-right: 1px solid #ddd;
    }
    #summary {
      flex: 1;
      padding: 1rem;
      font-family: sans-serif;
    }
    .btn {
      margin-right: 0.5rem;
      cursor: pointer;
      border: 1px solid #ccc;
      padding: 2px 6px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="board"></div>
  <div id="summary">
    <h3>é˜¶æ®µå°ç»“</h3>
    <div id="agreeList">âœ”ï¸ åŒæ„: æ— </div>
    <div id="denyList">âŒ å¦å®š: æ— </div>
    <button class="btn" onclick="exportSummary()">æ›´æ–°å°ç»“</button>
  </div>

  <script>
    const app = new window.tldraw.TldrawApp({
      container: document.getElementById("board"),
    });

    const cards = [
      { id: 'supporter', text: 'ğŸ© æ”¯æŒè€…\nä½ æœ‰äººè„‰ï¼Œæœºä¼šçª—å£æ­£å¥½', x: 100, y: 100 },
      { id: 'risk', text: 'ğŸ•¶ï¸ é£é™©é¡¾é—®\nèµ„é‡‘å‡†å¤‡ä¸è¶³ï¼Œå®¶åº­å‹åŠ›å¤§', x: 400, y: 100 },
      { id: 'neutral', text: 'ğŸ¤¹â€â™€ï¸ ä¸­ç«‹åˆ†æè€…\nå¯å°è¯•å‰¯ä¸šè¯•æ°´ï¼Œé™ä½é£é™©', x: 250, y: 300 },
    ];

    const statuses = {
      supporter: '',
      risk: '',
      neutral: ''
    };

    // åˆ›å»ºå¡ç‰‡ï¼Œå¸¦çŠ¶æ€èƒŒæ™¯
    cards.forEach(c => {
      app.createShape({
        id: c.id,
        type: 'text',
        x: c.x,
        y: c.y,
        props: {
          text: `${c.text}\n[âœ”ï¸åŒæ„] [âŒå¦å®š]`,
        }
      });
    });

    // ç®€å•å®ç°ç‚¹å‡»å½¢çŠ¶æ”¹å˜çŠ¶æ€
    app.on('shape:clicked', (shape) => {
      const id = shape.id;
      if (!id) return;
      if (statuses[id] === '') {
        statuses[id] = 'agree';
        updateShapeStyle(id, 'agree');
      } else if (statuses[id] === 'agree') {
        statuses[id] = 'deny';
        updateShapeStyle(id, 'deny');
      } else {
        statuses[id] = '';
        updateShapeStyle(id, '');
      }
    });

    function updateShapeStyle(id, status) {
      const shape = app.getShape(id);
      if (!shape) return;
      let fill = '#fff';
      if (status === 'agree') fill = '#eaffea';
      if (status === 'deny') fill = '#ffeaea';
      app.updateShape({
        id: id,
        props: { text: shape.props.text },
        style: { fill },
      });
    }

    function exportSummary() {
      let agree = [];
      let deny = [];
      Object.keys(statuses).forEach(id => {
        if (statuses[id] === 'agree') agree.push(id);
        if (statuses[id] === 'deny') deny.push(id);
      });
      document.getElementById('agreeList').innerText = 'âœ”ï¸ åŒæ„: ' + (agree.length ? agree.join(', ') : 'æ— ');
      document.getElementById('denyList').innerText = 'âŒ å¦å®š: ' + (deny.length ? deny.join(', ') : 'æ— ');
    }
  </script>
</body>
</html>
